{
  "version": 3,
  "sources": ["../../../../app/routes/users+/index.tsx"],
  "sourcesContent": ["// REMIX HMR BEGIN\nif (!window.$RefreshReg$ || !window.$RefreshSig$ || !window.$RefreshRuntime$) {\n  console.warn('remix:hmr: React Fast Refresh only works when the Remix compiler is running in development mode.');\n} else {\n  var prevRefreshReg = window.$RefreshReg$;\n  var prevRefreshSig = window.$RefreshSig$;\n  window.$RefreshReg$ = (type, id) => {\n    window.$RefreshRuntime$.register(type, \"\\\"app/routes/users+/index.tsx\\\"\" + id);\n  }\n  window.$RefreshSig$ = window.$RefreshRuntime$.createSignatureFunctionForTransform;\n}\nvar _s = $RefreshSig$();\nimport * as __hmr__ from \"remix:hmr\";\nif (import.meta) {\n  import.meta.hot = __hmr__.createHotContext(\n  //@ts-expect-error\n  \"app/routes/users+/index.tsx\");\n  import.meta.hot.lastModified = \"1700840307493.3254\";\n}\n// REMIX HMR END\n\nimport { json, redirect } from '@remix-run/node';\nimport { Link, useLoaderData } from '@remix-run/react';\nimport { z } from 'zod';\nimport { GeneralErrorBoundary } from '#app/components/error-boundary.tsx';\nimport { ErrorList } from '#app/components/forms.tsx';\nimport { SearchBar } from '#app/components/search-bar.tsx';\nimport { prisma } from '#app/utils/db.server.ts';\nimport { cn, getUserImgSrc, useDelayedIsPending } from '#app/utils/misc.tsx';\nconst UserSearchResultSchema = z.object({\n  id: z.string(),\n  username: z.string(),\n  name: z.string().nullable(),\n  imageId: z.string().nullable()\n});\nconst UserSearchResultsSchema = z.array(UserSearchResultSchema);\n_c = UserSearchResultsSchema;\nexport async function loader({\n  request\n}) {\n  const searchTerm = new URL(request.url).searchParams.get('search');\n  if (searchTerm === '') {\n    return redirect('/users');\n  }\n  const like = `%${searchTerm ?? ''}%`;\n  const rawUsers = await prisma.$queryRaw`\n\t\tSELECT User.id, User.username, User.name, UserImage.id AS imageId\n\t\tFROM User\n\t\tLEFT JOIN UserImage ON User.id = UserImage.userId\n\t\tWHERE User.username LIKE ${like}\n\t\tOR User.name LIKE ${like}\n\t\tORDER BY (\n\t\t\tSELECT Note.updatedAt\n\t\t\tFROM Note\n\t\t\tWHERE Note.ownerId = User.id\n\t\t\tORDER BY Note.updatedAt DESC\n\t\t\tLIMIT 1\n\t\t) DESC\n\t\tLIMIT 50\n\t`;\n  const result = UserSearchResultsSchema.safeParse(rawUsers);\n  if (!result.success) {\n    return json({\n      status: 'error',\n      error: result.error.message\n    }, {\n      status: 400\n    });\n  }\n  return json({\n    status: 'idle',\n    users: result.data\n  });\n}\nexport default function UsersRoute() {\n  _s();\n  const data = useLoaderData();\n  const isPending = useDelayedIsPending({\n    formMethod: 'GET',\n    formAction: '/users'\n  });\n  if (data.status === 'error') {\n    console.error(data.error);\n  }\n  return <div className=\"container mb-48 mt-36 flex flex-col items-center justify-center gap-6\">\n\t\t\t<h1 className=\"text-h1\">Epic Notes Users</h1>\n\t\t\t<div className=\"w-full max-w-[700px] \">\n\t\t\t\t<SearchBar status={data.status} autoFocus autoSubmit />\n\t\t\t</div>\n\t\t\t<main>\n\t\t\t\t{data.status === 'idle' ? data.users.length ? <ul className={cn('flex w-full flex-wrap items-center justify-center gap-4 delay-200', {\n        'opacity-50': isPending\n      })}>\n\t\t\t\t\t\t\t{data.users.map(user => <li key={user.id}>\n\t\t\t\t\t\t\t\t\t<Link to={user.username} className=\"flex h-36 w-44 flex-col items-center justify-center rounded-lg bg-muted px-5 py-3\">\n\t\t\t\t\t\t\t\t\t\t<img alt={user.name ?? user.username} src={getUserImgSrc(user.imageId)} className=\"h-16 w-16 rounded-full\" />\n\t\t\t\t\t\t\t\t\t\t{user.name ? <span className=\"w-full overflow-hidden text-ellipsis whitespace-nowrap text-center text-body-md\">\n\t\t\t\t\t\t\t\t\t\t\t\t{user.name}\n\t\t\t\t\t\t\t\t\t\t\t</span> : null}\n\t\t\t\t\t\t\t\t\t\t<span className=\"w-full overflow-hidden text-ellipsis text-center text-body-sm text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t{user.username}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t\t</li>)}\n\t\t\t\t\t\t</ul> : <p>No users found</p> : data.status === 'error' ? <ErrorList errors={['There was an error parsing the results']} /> : null}\n\t\t\t</main>\n\t\t</div>;\n}\n_s(UsersRoute, \"X4KRWZR4FN6itrOq+aVkJ8n94s8=\", false, function () {\n  return [useLoaderData, useDelayedIsPending];\n});\n_c2 = UsersRoute;\nexport function ErrorBoundary() {\n  return <GeneralErrorBoundary />;\n}\n_c3 = ErrorBoundary;\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"UserSearchResultsSchema\");\n$RefreshReg$(_c2, \"UsersRoute\");\n$RefreshReg$(_c3, \"ErrorBoundary\");\n\nwindow.$RefreshReg$ = prevRefreshReg;\nwindow.$RefreshSig$ = prevRefreshSig;"],
  "mappings": "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",
  "names": []
}
