{"version":3,"file":"userfeedback.js","sources":["../../../src/userfeedback.ts"],"sourcesContent":["import type { DsnComponents, EventEnvelope, SdkMetadata, UserFeedback, UserFeedbackItem } from '@sentry/types';\nimport { createEnvelope, dsnToString } from '@sentry/utils';\n\n/**\n * Creates an envelope from a user feedback.\n */\nexport function createUserFeedbackEnvelope(\n  feedback: UserFeedback,\n  {\n    metadata,\n    tunnel,\n    dsn,\n  }: {\n    metadata: SdkMetadata | undefined;\n    tunnel: string | undefined;\n    dsn: DsnComponents | undefined;\n  },\n): EventEnvelope {\n  const headers: EventEnvelope[0] = {\n    event_id: feedback.event_id,\n    sent_at: new Date().toISOString(),\n    ...(metadata &&\n      metadata.sdk && {\n        sdk: {\n          name: metadata.sdk.name,\n          version: metadata.sdk.version,\n        },\n      }),\n    ...(!!tunnel && !!dsn && { dsn: dsnToString(dsn) }),\n  };\n  const item = createUserFeedbackEnvelopeItem(feedback);\n\n  return createEnvelope(headers, [item]);\n}\n\nfunction createUserFeedbackEnvelopeItem(feedback: UserFeedback): UserFeedbackItem {\n  const feedbackHeaders: UserFeedbackItem[0] = {\n    type: 'user_report',\n  };\n  return [feedbackHeaders, feedback];\n}\n"],"names":[],"mappings":";;AAGA;AACA;AACA;AACA,SAAA,0BAAA;AACA,EAAA,QAAA;AACA,EAAA;AACA,IAAA,QAAA;AACA,IAAA,MAAA;AACA,IAAA,GAAA;AACA,GAAA;;AAIA;AACA,EAAA;AACA,EAAA,MAAA,OAAA,GAAA;AACA,IAAA,QAAA,EAAA,QAAA,CAAA,QAAA;AACA,IAAA,OAAA,EAAA,IAAA,IAAA,EAAA,CAAA,WAAA,EAAA;AACA,IAAA,IAAA,QAAA;AACA,MAAA,QAAA,CAAA,GAAA,IAAA;AACA,QAAA,GAAA,EAAA;AACA,UAAA,IAAA,EAAA,QAAA,CAAA,GAAA,CAAA,IAAA;AACA,UAAA,OAAA,EAAA,QAAA,CAAA,GAAA,CAAA,OAAA;AACA,SAAA;AACA,OAAA,CAAA;AACA,IAAA,IAAA,CAAA,CAAA,MAAA,IAAA,CAAA,CAAA,GAAA,IAAA,EAAA,GAAA,EAAA,WAAA,CAAA,GAAA,CAAA,EAAA,CAAA;AACA,GAAA,CAAA;AACA,EAAA,MAAA,IAAA,GAAA,8BAAA,CAAA,QAAA,CAAA,CAAA;AACA;AACA,EAAA,OAAA,cAAA,CAAA,OAAA,EAAA,CAAA,IAAA,CAAA,CAAA,CAAA;AACA,CAAA;AACA;AACA,SAAA,8BAAA,CAAA,QAAA,EAAA;AACA,EAAA,MAAA,eAAA,GAAA;AACA,IAAA,IAAA,EAAA,aAAA;AACA,GAAA,CAAA;AACA,EAAA,OAAA,CAAA,eAAA,EAAA,QAAA,CAAA,CAAA;AACA;;;;"}