{"version":3,"file":"db2i.formatter.js","names":["expandPhrases","functions","keywords","reservedSelect","reservedClauses","onelineClauses","reservedSetOperations","reservedJoins","reservedPhrases","db2i","tokenizerOptions","reservedKeywords","reservedFunctionNames","stringTypes","quote","prefixes","requirePrefix","identTypes","identChars","first","paramTypes","positional","named","paramChars","rest","operators","formatOptions"],"sources":["../../../src/languages/db2i/db2i.formatter.ts"],"sourcesContent":["import { DialectOptions } from '../../dialect.js';\nimport { expandPhrases } from '../../expandPhrases.js';\nimport { functions } from './db2i.functions.js';\nimport { keywords } from './db2i.keywords.js';\n\nconst reservedSelect = expandPhrases(['SELECT [ALL | DISTINCT]']);\n\nconst reservedClauses = expandPhrases([\n  // queries\n  'WITH',\n  'INTO',\n  'FROM',\n  'WHERE',\n  'GROUP BY',\n  'HAVING',\n  'PARTITION BY',\n  'ORDER [SIBLINGS] BY [INPUT SEQUENCE]',\n  'OFFSET',\n  'FETCH {FIRST | NEXT}',\n  'LIMIT',\n  'FOR UPDATE [OF]',\n  'FOR READ ONLY',\n  'OPTIMIZE FOR',\n  // Data modification\n  // - insert:\n  'INSERT INTO',\n  'VALUES',\n  // - update:\n  'SET',\n  // - merge:\n  'MERGE INTO',\n  'WHEN [NOT] MATCHED [THEN]',\n  'UPDATE SET',\n  'DELETE',\n  'INSERT',\n  // Data definition - table\n  'CREATE [OR REPLACE] TABLE',\n  'FOR SYSTEM NAME',\n  // Data definition - view\n  'CREATE [OR REPLACE] [RECURSIVE] VIEW',\n]);\n\nconst onelineClauses = expandPhrases([\n  // - update:\n  'UPDATE',\n  'WHERE CURRENT OF',\n  'WITH {NC | RR | RS | CS | UR}',\n  // - delete:\n  'DELETE FROM',\n  // - drop table:\n  'DROP TABLE',\n  // alter table:\n  'ALTER TABLE',\n  'ADD [COLUMN]',\n  'ALTER [COLUMN]',\n  'DROP [COLUMN]',\n  'RENAME [COLUMN]',\n  'SET DATA TYPE', // for alter column\n  'SET {GENERATED ALWAYS | GENERATED BY DEFAULT}', // for alter column\n  'SET NOT NULL', // for alter column\n  'SET {NOT HIDDEN | IMPLICITLY HIDDEN}', // for alter column\n  'SET FIELDPROC', // for alter column\n  'DROP {DEFAULT | NOT NULL | GENERATED | IDENTITY | ROW CHANGE TIMESTAMP | FIELDPROC}', // for alter column\n  // - truncate:\n  'TRUNCATE [TABLE]',\n  // other\n  'SET [CURRENT] SCHEMA',\n  'SET CURRENT_SCHEMA',\n  // https://www.ibm.com/docs/en/i/7.5?topic=reference-statements\n  'ALLOCATE CURSOR',\n  'ALLOCATE [SQL] DESCRIPTOR [LOCAL | GLOBAL] SQL',\n  'ALTER [SPECIFIC] {FUNCTION | PROCEDURE}',\n  'ALTER {MASK | PERMISSION | SEQUENCE | TRIGGER}',\n  'ASSOCIATE [RESULT SET] {LOCATOR | LOCATORS}',\n  'BEGIN DECLARE SECTION',\n  'CALL',\n  'CLOSE',\n  'COMMENT ON {ALIAS | COLUMN | CONSTRAINT | INDEX | MASK | PACKAGE | PARAMETER | PERMISSION | SEQUENCE | TABLE | TRIGGER | VARIABLE | XSROBJECT}',\n  'COMMENT ON [SPECIFIC] {FUNCTION | PROCEDURE | ROUTINE}',\n  'COMMENT ON PARAMETER SPECIFIC {FUNCTION | PROCEDURE | ROUTINE}',\n  'COMMENT ON [TABLE FUNCTION] RETURN COLUMN',\n  'COMMENT ON [TABLE FUNCTION] RETURN COLUMN SPECIFIC [PROCEDURE | ROUTINE]',\n  'COMMIT [WORK] [HOLD]',\n  'CONNECT [TO | RESET] USER',\n  'CREATE [OR REPLACE] {ALIAS | FUNCTION | MASK | PERMISSION | PROCEDURE | SEQUENCE | TRIGGER | VARIABLE}',\n  'CREATE [ENCODED VECTOR] INDEX',\n  'CREATE UNIQUE [WHERE NOT NULL] INDEX',\n  'CREATE SCHEMA',\n  'CREATE TYPE',\n  'DEALLOCATE [SQL] DESCRIPTOR [LOCAL | GLOBAL]',\n  'DECLARE CURSOR',\n  'DECLARE GLOBAL TEMPORARY TABLE',\n  'DECLARE',\n  'DESCRIBE CURSOR',\n  'DESCRIBE INPUT',\n  'DESCRIBE [OUTPUT]',\n  'DESCRIBE {PROCEDURE | ROUTINE}',\n  'DESCRIBE TABLE',\n  'DISCONNECT ALL [SQL]',\n  'DISCONNECT [CURRENT]',\n  'DROP {ALIAS | INDEX | MASK | PACKAGE | PERMISSION | SCHEMA | SEQUENCE | TABLE | TYPE | VARIABLE | XSROBJECT} [IF EXISTS]',\n  'DROP [SPECIFIC] {FUNCTION | PROCEDURE | ROUTINE} [IF EXISTS]',\n  'END DECLARE SECTION',\n  'EXECUTE [IMMEDIATE]',\n  // 'FETCH {NEXT | PRIOR | FIRST | LAST | BEFORE | AFTER | CURRENT} [FROM]',\n  'FREE LOCATOR',\n  'GET [SQL] DESCRIPTOR [LOCAL | GLOBAL]',\n  'GET [CURRENT | STACKED] DIAGNOSTICS',\n  'GRANT {ALL [PRIVILEGES] | ALTER | EXECUTE} ON {FUNCTION | PROCEDURE | ROUTINE | PACKAGE | SCHEMA | SEQUENCE | TABLE | TYPE | VARIABLE | XSROBJECT}',\n  'HOLD LOCATOR',\n  'INCLUDE',\n  'LABEL ON {ALIAS | COLUMN | CONSTRAINT | INDEX | MASK | PACKAGE | PERMISSION | SEQUENCE | TABLE | TRIGGER | VARIABLE | XSROBJECT}',\n  'LABEL ON [SPECIFIC] {FUNCTION | PROCEDURE | ROUTINE}',\n  'LOCK TABLE',\n  'OPEN',\n  'PREPARE',\n  'REFRESH TABLE',\n  'RELEASE',\n  'RELEASE [TO] SAVEPOINT',\n  'RENAME [TABLE | INDEX] TO',\n  'REVOKE {ALL [PRIVILEGES] | ALTER | EXECUTE} ON {FUNCTION | PROCEDURE | ROUTINE | PACKAGE | SCHEMA | SEQUENCE | TABLE | TYPE | VARIABLE | XSROBJECT}',\n  'ROLLBACK [WORK] [HOLD | TO SAVEPOINT]',\n  'SAVEPOINT',\n  'SET CONNECTION',\n  'SET CURRENT {DEBUG MODE | DECFLOAT ROUNDING MODE | DEGREE | IMPLICIT XMLPARSE OPTION | TEMPORAL SYSTEM_TIME}',\n  'SET [SQL] DESCRIPTOR [LOCAL | GLOBAL]',\n  'SET ENCRYPTION PASSWORD',\n  'SET OPTION',\n  'SET {[CURRENT [FUNCTION]] PATH | CURRENT_PATH}',\n  'SET RESULT SETS [WITH RETURN [TO CALLER | TO CLIENT]',\n  'SET SESSION AUTHORIZATION',\n  'SET SESSION_USER',\n  'SET TRANSACTION',\n  'SIGNAL SQLSTATE [VALUE]',\n  'TAG',\n  'TRANSFER OWNERSHIP OF',\n  'WHENEVER {NOT FOUND | SQLERROR | SQLWARNING}',\n]);\n\nconst reservedSetOperations = expandPhrases(['UNION [ALL]', 'EXCEPT [ALL]', 'INTERSECT [ALL]']);\n\nconst reservedJoins = expandPhrases([\n  'JOIN',\n  '{LEFT | RIGHT | FULL} [OUTER] JOIN',\n  '{LEFT | RIGHT } EXCEPTION JOIN',\n  '{INNER | CROSS} JOIN',\n]);\n\nconst reservedPhrases = expandPhrases([\n  'ON DELETE',\n  'ON UPDATE',\n  'SET NULL',\n  '{ROWS | RANGE} BETWEEN',\n]);\n\n// https://www.ibm.com/docs/en/i/7.5?topic=reference-sql\nexport const db2i: DialectOptions = {\n  tokenizerOptions: {\n    reservedSelect,\n    reservedClauses: [...reservedClauses, ...onelineClauses],\n    reservedSetOperations,\n    reservedJoins,\n    reservedPhrases,\n    reservedKeywords: keywords,\n    reservedFunctionNames: functions,\n    stringTypes: [\n      { quote: \"''-qq\", prefixes: ['G', 'N', 'U&'] },\n      { quote: \"''-raw\", prefixes: ['X', 'BX', 'GX', 'UX'], requirePrefix: true },\n    ],\n    identTypes: [`\"\"-qq`],\n    identChars: { first: '@#$' },\n    paramTypes: { positional: true, named: [':'] },\n    paramChars: { first: '@#$', rest: '@#$' },\n    operators: ['**', '¬=', '¬>', '¬<', '!>', '!<', '||'],\n  },\n  formatOptions: {\n    onelineClauses,\n  },\n};\n"],"mappings":"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"}